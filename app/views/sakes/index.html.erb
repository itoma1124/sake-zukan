<%= render "shared/header"%>
<main>
  <div class="album py-5 bg-light">
    <div class="container d-flex justify-content-between",id="title">
      <h2>„Äú„Åø„Çì„Å™„ÅÆÈÖí„É°„É¢„Äú</h2>
      <%# Ê§úÁ¥¢„Éê„Éº %>
        <%= search_form_for @q, url: sakes_search_path,class:"my-auto text-body" do |f| %>
          <%= sort_link(@q, :created_at, "ÁôªÈå≤Êó•")%>
          <%= sort_link(@q, :name, "ÂêçÂâç:")%>
          <%= f.collection_select :name_cont, @name, :name, :name, include_blank: 'ÊåáÂÆö„Å™„Åó'%>
          <%= sort_link(@q, :category, "Á®ÆÈ°û:")%>
          <%= f.collection_select :category_eq, @category, :category, :category, include_blank: 'ÊåáÂÆö„Å™„Åó'%>
          <%= sort_link(@q, :total_id, "Ë©ï‰æ°:")%>
          <%= f.collection_select :total_id_eq, Total.all, :id, :name, include_blank: 'ÊåáÂÆö„Å™„Åó'%>
          <%= f.submit "Ê§úÁ¥¢" %>
        <% end %>
      <%# /Ê§úÁ¥¢„Éê„Éº %>
    </div><%# /id:title %>
    <div class="container ",id="lists">
      <div class="d-flex flex-wrap">
        <% @sakes.each do |sake| %>
            <!--cardÂÜÖÊû†-->
            <li class="col-3 shadow-sm my-1 list-group-item "> 
              <!--card‰∏äÈÉ®-->
              <%if sake.image.attached?%>
                <%=link_to(sake_path(sake.id))do%>
                  <%= image_tag sake.image, size:'200x200',class:'card-img-top object-fit-cover'%>
                <%end%>
              <%else%>
                <%=link_to(sake_path(sake.id))do%>
                  <%= image_tag 'no-image.png', size:'200x200', class: 'card-img-top object-fit-cover'%> 
                <%end%>
              <%end%>
              <!--/card‰∏äÈÉ®-->
              <!--card‰∏ãÈÉ®-->
              <div class="container">
                <p class="card-text">
                  <%=link_to(sake_path(sake.id),class:"text-body")do%>
                    <h3><%= sake.name %></h3>
                  <%end%>
                </p>
                <p class="font-s">
                    „ÄÄ„ÄÄÁ®ÆÈ°û:<%= sake.category %><br>
                    Á∑èÂêàË©ï‰æ°:<%= sake.total.name %>
                </p>

                <div class="btn-group d-flex justify-content-between h-3">
                  <%=link_to sake.user.nickname,"/users/#{sake.user_id}",class:"col-7 text-body"%><!--„É¶„Éº„Ç∂„ÉºÂêç-->
                  <%if user_signed_in? && current_user.id != sake.user_id %>
                    <%unless Favorite.exists?(user_id:current_user.id,sake_id:sake.id) %>
                      <%= link_to "‚ô° #{sake.favorites.length}",sake_favorites_path(sake),method: :post, class: "btn font-xl text-danger text-right " %><!--„ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥ON-->
                    <%else%>
                      <%= link_to "‚ù§Ô∏è #{sake.favorites.length}", sake_favorites_path(sake),method: :delete, class: "btn font-xl text-danger text-right"%><!--„ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥OFF-->
                    <% end %>
                  <%else%>
                    <div class="font-xl text-danger text-right">‚ù§Ô∏è <%=sake.favorites.length%></div>
                  <%end%>
                </div>
              </div>
              <!--/card‰∏ãÈÉ®-->
            </li>
            <!--/cardÂÜÖÊû†-->
        <%end%>
      </div>
         <div class="d-flex justify-content-center"><%= paginate @sakes%></div><!--„Éö„Éº„Ç∏Âàá„ÇäÊõø„Åà„Éú„Çø„É≥-->
    </div><!--id:lists-->

    <%# „ÅÑ„ÅÑ„Å≠„É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫ %>
    <div class="container">
      <h2>„Äú„ÅÑ„ÅÑ„Å≠„É©„É≥„Ç≠„É≥„Ç∞„Äú</h2>
    </div>
    <div class="container d-flex scroll-x",id="lists">
      <%@sake_rank.each.with_index(1) do|sake,i|%>
        <li class="col-3 shadow-sm my-1 list-group-item "> 
          <!--card‰∏äÈÉ®-->
          <%if sake.image.attached?%>
            <%=link_to(sake_path(sake.id))do%>
              <%= image_tag sake.image, size:'200x200',class:'card-img-top object-fit-cover'%>
            <%end%>
          <%else%>
            <%=link_to(sake_path(sake.id))do%>
              <%= image_tag 'no-image.png', size:'200x200', class: 'card-img-top object-fit-cover'%> 
            <%end%>
          <%end%>
          <div class="d-flex justify-content-between">
            <%=link_to(sake_path(sake.id),class:"text-body")do%>
               <% if i == 1%>
                <div>ü•áÁ¨¨<%=i%>‰Ωç</div>
              <%elsif i == 2%>
                <div>ü•àÁ¨¨<%=i%>‰Ωç</div>
              <%elsif i == 3%>
                <div>ü•âÁ¨¨<%=i%>‰Ωç</div>
              <%else%>
                <div>Á¨¨<%=i%>‰Ωç</div>
              <%end%>
              <h3 class="my-auto"><%= sake.name %></h3>
            <%end%>
            <div class="d-flex">
              <%if user_signed_in? && current_user.id != sake.user_id %>
                <%unless Favorite.exists?(user_id:current_user.id,sake_id:sake.id) %>
                  <%= link_to "‚ô° #{sake.favorites.length}",sake_favorites_path(sake),method: :post, class: "btn font-xl text-danger text-right mt-3" %><!--„ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥ON-->
                <%else%>
                  <%= link_to "‚ù§Ô∏è #{sake.favorites.length}", sake_favorites_path(sake),method: :delete, class: "btn font-xl text-danger mt-3"%><!--„ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥OFF-->
                <% end %>
              <%end%>
            </div>
          </div>
        </li>
      <%end%>
    </div>
    <%# „ÅÑ„ÅÑ„Å≠„É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫ %>

     <%# „É¶„Éº„Ç∂„Éº„É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫ %>
    <div class="container mt-5">
      <h2>„ÄúÊäïÁ®øÊï∞„É©„É≥„Ç≠„É≥„Ç∞„Äú</h2>
    </div>
    <div class="container d-flex scroll-x",id="lists">
      <%@user_rank.each.with_index(1) do|user,i|%>
        <li class="col-3 shadow-sm py-3 my-1 list-group-item "> 
          <%=link_to(user_path(user.id),class:"text-body")do%>
            <% if i == 1%>
                <div>ü•áÁ¨¨<%=i%>‰Ωç</div>
              <%elsif i == 2%>
                <div>ü•àÁ¨¨<%=i%>‰Ωç</div>
              <%elsif i == 3%>
                <div>ü•âÁ¨¨<%=i%>‰Ωç</div>
              <%else%>
                <div>Á¨¨<%=i%>‰Ωç</div>
              <%end%>
            <h3 class="my-auto"><%= user.nickname %></h3>
            ÊäïÁ®ø:<%=user.sakes.length%>
          <%end%>
        </li>
      <%end%>  
    </div>
    <%# „ÅÑ„ÅÑ„Å≠„É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫ %>


  </div><!-- /album py-5 bg-light -->
</main>